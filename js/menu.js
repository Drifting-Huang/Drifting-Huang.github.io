function MenuItem(){this.parent=void 0,this.element=void 0,this.data=void 0,this.width=0,this.height=0,this.currentAnimation=0}function Menu(){this.items=new Array}function createMenuItem(a){var b=void 0!=a&&void 0!=a.menuItemClass?a.menuItemClass:"MenuItem";return new window[b]}function createMenu(a){var b=void 0!=a&&void 0!=a.menuClass?a.menuClass:"Menu";return new window[b]}function setupMenu(a){if(menuData=getMenuData(a),void 0==menuData)return!1;var b=menuData.items,c=createMenu(menuData),d=$(a).parent(),e=$(d).data("itemData");void 0!=e&&(e.subMenu=c),c.setData(menuData,a);var f=!0;return $(a).children("li").each(function(){var a=createMenuItem(b);return a.setData(b,this),c.items.push(a),$(this).children("ul").each(function(){return f=setupMenu(this),f?void 0:!1}),f?void a.addEvents():!1}),c.addEvents(),f}function closeMenu(a){$(a).children().each(function(){var a=$(this).data("itemData");void 0!==a&&(void 0!=a.subMenu&&closeMenu($(this).children("ul")),a.animate("hover_out"))})}function getMenuData(a){var b=void 0,c=$(a).attr("class").split(/\s+/);return $.each(c,function(a,c){return b=getMenuDataForClass(c),void 0!=b?!1:void 0}),b}function getMenuDataForClass(a){return menuClasses[a]}function registerMenuClass(a,b){menuClasses[a]=b}function initMenu(a){return setupMenu(a)?!0:!1}function updateMenuDefaults(a){var b=$(a).data("itemData");b.updateDefaults(a)}function setMenuDefaultSize(a){var b=$(a).data("itemData");b.setDefaultSize(a)}function showRaw(a){$(a).each(function(){$(this).css("display","block"),$(this).css("*display","inline"),$(this).children().each(function(){showRaw(this)});$(this).width(),$(this).height();0==$(this).width()&&$(this).css("width","initial"),0==$(this).height()&&$(this).css("height","initial")})}function show(a){$(a).each(function(){"none"==$(this).css("display")&&($(this).css("display","block"),$(this).css("*display","inline"))}),$(document).bind("touchend",function(b){for(var c=$(a).data("itemData");void 0!=c.parent;)c=c.parent,a=c.element;a.contains(b.target)||closeMenu(a)})}MenuItem.prototype.createMenuItem=function(a,b){var c=$("<li></li>");return this.setData(a,c,b),void 0!=a.submenu&&(this.subMenu=createMenu(a.submenu),this.subMenu.createMenu(a.submenu,c)),this.addEvents(),c},MenuItem.prototype.attachMenuItem=function(a,b){var c=this;return c.setData(a,b),void 0!=a.submenu&&$(b).children("ul").each(function(){c.subMenu=createMenu(a.submenu),c.subMenu.attachMenu(a.submenu,this)}),c.addEvents(),b},MenuItem.prototype.setData=function(a,b,c){this.data=a,this.element=b,void 0!=c?($(c).append(b),$(b).append(this.menuContent())):c=$(b).parent();var d=$(c).data("itemData");this.parent=void 0!=d?d:void 0,void 0==$(b).attr("id")&&void 0!=a.id&&$(b).attr("id",a.id),void 0==$(b).attr("class")&&void 0!=a.cssClass&&$(b).attr("class",a.cssClass),void 0!=a.position&&($(b).css("marginLeft",a.position.x),$(b).css("marginTop",a.position.y)),void 0!=a.size&&($(b).css("width",a.size.width),$(b).css("height",a.size.height)),$(b).data("itemData",this)},MenuItem.prototype.addEvents=function(){var a=this.element;void 0!=this.data.hover?$(a).hover(this.hover):void 0!=this.data.hover_in&&void 0!=this.data.hover_out&&$(a).hover(this.hoverIn,this.hoverOut);var b=this.subMenu,c=this.parent?this.parent.element:void 0;void 0!=b&&$(a).on("click",function(a){a.stopPropagation(),"none"==$(b.element).css("display")?$(this).mouseenter():void 0!=c&&closeMenu(c)})},MenuItem.prototype.updateDefaults=function(a){void 0==a&&(a=this.element),$(a).children("ul").each(function(){updateMenuDefaults(this)});var b=$(a).find(".menu-content");this.width=$(b).width()+1,this.height=$(b).height()},MenuItem.prototype.setDefaultSize=function(a){void 0==a&&(a=this.element),$(a).children("ul").each(function(){setMenuDefaultSize(this)}),$(a).find(".menu-content").width(this.width),$(a).find(".menu-content").height(this.height)},MenuItem.prototype.getAnimationProperties=function(a){var b=jQuery.extend({},a);return"final"==b.width&&(b.width=this.width),"final"==b.height&&(b.height=this.height),"final"==b["min-width"]&&(b["min-width"]=this.width),"final"==b["min-height"]&&(b["min-height"]=this.height),b},MenuItem.prototype.animate=function(a,b){var c=this;++c.currentAnimation;var d=c.element;if(void 0!=c.data[a].before&&c.before(c.getAnimationProperties(c.data[a].before)),void 0==b&&(b=c.data[a].delay),void 0!=b){var e=c.currentAnimation;setTimeout(function(){e==c.currentAnimation&&($(d).stop(),$(d).animate(c.getAnimationProperties(c.data[a].properties),1==c.data[a].animate?c.data[a].duration:0,function(){c.after(c.getAnimationProperties(c.data[a].after))}))},b)}else $(d).stop(),$(d).animate(c.getAnimationProperties(c.data[a].properties),1==c.data[a].animate?c.data[a].duration:0,function(){c.after(c.getAnimationProperties(c.data[a].after))});if(void 0!=c.data[a].content&&(b=c.data[a].content.delay,c.animateContent(c.data[a].content.event,b)),void 0!=c.data[a].submenu){var f=c.data[a].submenu.event;if(b=c.data[a].submenu.delay,void 0!=c.subMenu)if("function"==typeof c.subMenu[f])if(void 0!=b){var e=c.subMenu.currentAnimation;setTimeout(function(){e==c.subMenu.currentAnimation&&c.subMenu[f].call(c.subMenu.element)},b)}else c.subMenu[f].call(c.subMenu.element);else c.subMenu.animate(f,b,function(){c.subMenu.after(c.getAnimationProperties(c.subMenu[f].after))})}},MenuItem.prototype.animateContent=function(a,b){var c=this;if(void 0==b&&(b=c.data.content[a].delay),void 0!=b){var d=this.currentAnimation;setTimeout(function(){d==c.currentAnimation&&c.doAnimateContent(a)},b)}else c.doAnimateContent(a)},MenuItem.prototype.doAnimateContent=function(a){var b=this,c=Element=b.element,d=$(c).find(".menu-content"),e=b.data.content[a];$(d).stop(),$(d).animate(b.getAnimationProperties(e.properties),1==e.animate?e.duration:0,function(){void 0!=e.after&&$(this).css(e.after)});for(var f in e)if(0==f.indexOf("child:")){var g=parseInt(f.substr(6)),h=$(d).children().eq(g);void 0!=e[f].tag&&(h=$(h).find(e[f].tag)),$(h).stop(),$(h).animate(b.getAnimationProperties(e[f].properties),1==e.animate?void 0!=e[f].duration?e[f].duration:e.duration:0,function(){void 0!=e[f].after&&$(this).css(e[f].after)})}},MenuItem.prototype.before=function(a){void 0!=a&&$(this.element).css(a)},MenuItem.prototype.after=function(a){void 0!=a&&$(this.element).css(a)},MenuItem.prototype.hover=function(){var a=$(this).data("itemData");a.animate("hover")},MenuItem.prototype.hoverIn=function(){var a=$(this).data("itemData");a.animate("hover_in")},MenuItem.prototype.hoverOut=function(){var a=$(this).data("itemData");a.animate("hover_out")},MenuItem.prototype.show=function(){var a=$(this).data("itemData");show(this),a.animate("show")},MenuItem.prototype.hide=function(){var a=$(this).data("itemData");a.animate("hide")},MenuItem.prototype.menuContent=function(){var a='<div class="menu-content"><div class="menu-label">'+this.data.content.label+"</div></div>";return a},Menu.prototype=new MenuItem,Menu.prototype.createMenu=function(a,b){var c=$("<ul></ul>");this.setData(a,c,b);for(var d in a.items){var e=a.items[d],f=createMenuItem(e);f.createMenuItem(e,c),this.items.push(f)}return this.addEvents(),c},Menu.prototype.attachMenu=function(a,b){var c=this;if(c.setData(a,b),void 0!=a.items){var d=0;$(b).children("li").each(function(){if(d<a.items.length){var b=a.items[d++],e=createMenuItem(b);e.attachMenuItem(b,this),c.items.push(e)}})}return c.addEvents(),b},Menu.prototype.updateDefaults=function(a){void 0==a&&(a=this.element);var b=this,c=void 0!=b.data.vertical?b.data.vertical:!1;b.width=0,b.height=0,$(a).children("li").each(function(){updateMenuDefaults(this);var a=$(this).data("itemData");c?(b.height+=a.height,a.width>b.width&&(b.width=a.width)):(b.width+=a.width,a.height>b.height&&(b.height=a.height))})},Menu.prototype.setDefaultSize=function(a){void 0==a&&(a=this.element),$(a).children("li").each(function(){setMenuDefaultSize(this)})},Menu.prototype.menuContent=function(){return this.data.label},Menu.prototype.animateContent=function(a,b){for(var c in this.items){var d=this.items[c];d.animateContent(a,b)}};var menuClasses={};